<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>readme.html</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<pre># once

Only call a function once.

## usage

```javascript
var once = require(&#x27;once&#x27;)

function load (file, cb) {
  cb = once(cb)
  loader.load(&#x27;file&#x27;)
  loader.once(&#x27;load&#x27;, cb)
  loader.once(&#x27;error&#x27;, cb)
}
```

Or add to the Function.prototype in a responsible way:

```javascript
// only has to be done once
require(&#x27;once&#x27;).proto()

function load (file, cb) {
  cb = cb.once()
  loader.load(&#x27;file&#x27;)
  loader.once(&#x27;load&#x27;, cb)
  loader.once(&#x27;error&#x27;, cb)
}
```

Ironically, the prototype feature makes this module twice as
complicated as necessary.

To check whether you function has been called, use `fn.called`. Once the
function is called for the first time the return value of the original
function is saved in `fn.value` and subsequent calls will continue to
return this value.

```javascript
var once = require(&#x27;once&#x27;)

function load (cb) {
  cb = once(cb)
  var stream = createStream()
  stream.once(&#x27;data&#x27;, cb)
  stream.once(&#x27;end&#x27;, function () {
    if (!cb.called) cb(new Error(&#x27;not found&#x27;))
  })
}
```

## `once.strict(func)`

Throw an error if the function is called twice.

Some functions are expected to be called only once. Using `once` for them would
potentially hide logical errors.

In the example below, the `greet` function has to call the callback only once:

```javascript
function greet (name, cb) {
  // return is missing from the if statement
  // when no name is passed, the callback is called twice
  if (!name) cb(&#x27;Hello anonymous&#x27;)
  cb(&#x27;Hello &#x27; + name)
}

function log (msg) {
  console.log(msg)
}

// this will print &#x27;Hello anonymous&#x27; but the logical error will be missed
greet(null, once(msg))

// once.strict will print &#x27;Hello anonymous&#x27; and throw an error when the callback will be called the second time
greet(null, once.strict(msg))
```
</pre>
</body>
</html>